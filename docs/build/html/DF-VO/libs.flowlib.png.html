

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>libs.flowlib.png &mdash; DF-VO latest documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="libs.general" href="libs.general.html" />
    <link rel="prev" title="libs.flowlib.flowlib" href="libs.flowlib.flowlib.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> DF-VO
          

          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">introduction</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../rsts/introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rsts/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rsts/examples.html">Examples</a></li>
</ul>
<p class="caption"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="apis.html">apis</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="libs.html">libs</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="libs.datasets.html">libs.datasets</a></li>
<li class="toctree-l2"><a class="reference internal" href="libs.deep_models.html">libs.deep_models</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="libs.flowlib.html">libs.flowlib</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="libs.flowlib.flowlib.html">libs.flowlib.flowlib</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">libs.flowlib.png</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="libs.general.html">libs.general</a></li>
<li class="toctree-l2"><a class="reference internal" href="libs.geometry.html">libs.geometry</a></li>
<li class="toctree-l2"><a class="reference internal" href="libs.matching.html">libs.matching</a></li>
<li class="toctree-l2"><a class="reference internal" href="libs.tracker.html">libs.tracker</a></li>
<li class="toctree-l2"><a class="reference internal" href="libs.dfvo.html">libs.dfvo</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tools.html">tools</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">DF-VO</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="libs.html">libs</a> &raquo;</li>
        
          <li><a href="libs.flowlib.html">libs.flowlib</a> &raquo;</li>
        
      <li>libs.flowlib.png</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/DF-VO/libs.flowlib.png.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-libs.flowlib.png">
<span id="libs-flowlib-png"></span><h1>libs.flowlib.png<a class="headerlink" href="#module-libs.flowlib.png" title="Permalink to this headline">¶</a></h1>
<dl class="py class">
<dt id="libs.flowlib.png.Image">
<em class="property"><span class="pre">class</span> </em><code class="sig-name descname"><span class="pre">Image</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rows</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">info</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/libs/flowlib/png.html#Image"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#libs.flowlib.png.Image" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>A PNG image.  You can create an <a class="reference internal" href="#libs.flowlib.png.Image" title="libs.flowlib.png.Image"><code class="xref py py-class docutils literal notranslate"><span class="pre">Image</span></code></a> object from
an array of pixels by calling <code class="xref py py-meth docutils literal notranslate"><span class="pre">png.from_array()</span></code>.  It can be
saved to disk with the <a class="reference internal" href="#libs.flowlib.png.Image.save" title="libs.flowlib.png.Image.save"><code class="xref py py-meth docutils literal notranslate"><span class="pre">save()</span></code></a> method.</p>
<dl class="py method">
<dt id="libs.flowlib.png.Image.__init__">
<code class="sig-name descname"><span class="pre">__init__</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rows</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">info</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/libs/flowlib/png.html#Image.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#libs.flowlib.png.Image.__init__" title="Permalink to this definition">¶</a></dt>
<dd><div class="admonition note">
<p class="admonition-title">Note</p>
<p>The constructor is not public.  Please do not call it.</p>
</div>
</dd></dl>

<dl class="py method">
<dt id="libs.flowlib.png.Image.save">
<code class="sig-name descname"><span class="pre">save</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/libs/flowlib/png.html#Image.save"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#libs.flowlib.png.Image.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the image to <em>file</em>.  If <em>file</em> looks like an open file
descriptor then it is used, otherwise it is treated as a
filename and a fresh file is opened.</p>
<p>In general, you can only call this method once; after it has
been called the first time and the PNG image has been saved, the
source data will have been streamed, and cannot be streamed
again.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="libs.flowlib.png.Reader">
<em class="property"><span class="pre">class</span> </em><code class="sig-name descname"><span class="pre">Reader</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">_guess</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kw</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/libs/flowlib/png.html#Reader"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#libs.flowlib.png.Reader" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>PNG decoder in pure Python.</p>
<dl class="py method">
<dt id="libs.flowlib.png.Reader.__init__">
<code class="sig-name descname"><span class="pre">__init__</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">_guess</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kw</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/libs/flowlib/png.html#Reader.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#libs.flowlib.png.Reader.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a PNG decoder object.</p>
<p>The constructor expects exactly one keyword argument. If you
supply a positional argument instead, it will guess the input
type. You can choose among the following keyword arguments:</p>
<dl class="simple">
<dt>filename</dt><dd><p>Name of input file (a PNG file).</p>
</dd>
<dt>file</dt><dd><p>A file-like object (object with a read() method).</p>
</dd>
<dt>bytes</dt><dd><p><code class="docutils literal notranslate"><span class="pre">array</span></code> or <code class="docutils literal notranslate"><span class="pre">string</span></code> with PNG data.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="libs.flowlib.png.Reader.asDirect">
<code class="sig-name descname"><span class="pre">asDirect</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/libs/flowlib/png.html#Reader.asDirect"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#libs.flowlib.png.Reader.asDirect" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the image data as a direct representation of an
<code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">*</span> <span class="pre">y</span> <span class="pre">*</span> <span class="pre">planes</span></code> array.  This method is intended to remove the
need for callers to deal with palettes and transparency
themselves.  Images with a palette (colour type 3)
are converted to RGB or RGBA; images with transparency (a
<code class="docutils literal notranslate"><span class="pre">tRNS</span></code> chunk) are converted to LA or RGBA as appropriate.
When returned in this format the pixel values represent the
colour value directly without needing to refer to palettes or
transparency information.</p>
<p>Like the <a class="reference internal" href="#libs.flowlib.png.Reader.read" title="libs.flowlib.png.Reader.read"><code class="xref py py-meth docutils literal notranslate"><span class="pre">read()</span></code></a> method this method returns a 4-tuple:</p>
<p>(<em>width</em>, <em>height</em>, <em>pixels</em>, <em>meta</em>)</p>
<p>This method normally returns pixel values with the bit depth
they have in the source image, but when the source PNG has an
<code class="docutils literal notranslate"><span class="pre">sBIT</span></code> chunk it is inspected and can reduce the bit depth of
the result pixels; pixel values will be reduced according to
the bit depth specified in the <code class="docutils literal notranslate"><span class="pre">sBIT</span></code> chunk (PNG nerds should
note a single result bit depth is used for all channels; the
maximum of the ones specified in the <code class="docutils literal notranslate"><span class="pre">sBIT</span></code> chunk.  An RGB565
image will be rescaled to 6-bit RGB666).</p>
<p>The <em>meta</em> dictionary that is returned reflects the <cite>direct</cite>
format and not the original source image.  For example, an RGB
source image with a <code class="docutils literal notranslate"><span class="pre">tRNS</span></code> chunk to represent a transparent
colour, will have <code class="docutils literal notranslate"><span class="pre">planes=3</span></code> and <code class="docutils literal notranslate"><span class="pre">alpha=False</span></code> for the
source image, but the <em>meta</em> dictionary returned by this method
will have <code class="docutils literal notranslate"><span class="pre">planes=4</span></code> and <code class="docutils literal notranslate"><span class="pre">alpha=True</span></code> because an alpha
channel is synthesized and added.</p>
<p><em>pixels</em> is the pixel data in boxed row flat pixel format (just
like the <a class="reference internal" href="#libs.flowlib.png.Reader.read" title="libs.flowlib.png.Reader.read"><code class="xref py py-meth docutils literal notranslate"><span class="pre">read()</span></code></a> method).</p>
<p>All the other aspects of the image data are not changed.</p>
</dd></dl>

<dl class="py method">
<dt id="libs.flowlib.png.Reader.asFloat">
<code class="sig-name descname"><span class="pre">asFloat</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">maxval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/libs/flowlib/png.html#Reader.asFloat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#libs.flowlib.png.Reader.asFloat" title="Permalink to this definition">¶</a></dt>
<dd><p>Return image pixels as per <a class="reference internal" href="#libs.flowlib.png.Reader.asDirect" title="libs.flowlib.png.Reader.asDirect"><code class="xref py py-meth docutils literal notranslate"><span class="pre">asDirect()</span></code></a> method, but scale
all pixel values to be floating point values between 0.0 and
<em>maxval</em>.</p>
</dd></dl>

<dl class="py method">
<dt id="libs.flowlib.png.Reader.asRGB">
<code class="sig-name descname"><span class="pre">asRGB</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/libs/flowlib/png.html#Reader.asRGB"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#libs.flowlib.png.Reader.asRGB" title="Permalink to this definition">¶</a></dt>
<dd><p>Return image as RGB pixels.  RGB colour images are passed
through unchanged; greyscales are expanded into RGB
triplets (there is a small speed overhead for doing this).</p>
<p>An alpha channel in the source image will raise an
exception.</p>
<p>The return values are as for the <a class="reference internal" href="#libs.flowlib.png.Reader.read" title="libs.flowlib.png.Reader.read"><code class="xref py py-meth docutils literal notranslate"><span class="pre">read()</span></code></a> method
except that the <em>metadata</em> reflect the returned pixels, not the
source image.  In particular, for this method
<code class="docutils literal notranslate"><span class="pre">metadata['greyscale']</span></code> will be <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt id="libs.flowlib.png.Reader.asRGB8">
<code class="sig-name descname"><span class="pre">asRGB8</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/libs/flowlib/png.html#Reader.asRGB8"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#libs.flowlib.png.Reader.asRGB8" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the image data as an RGB pixels with 8-bits per
sample.  This is like the <a class="reference internal" href="#libs.flowlib.png.Reader.asRGB" title="libs.flowlib.png.Reader.asRGB"><code class="xref py py-meth docutils literal notranslate"><span class="pre">asRGB()</span></code></a> method except that
this method additionally rescales the values so that they
are all between 0 and 255 (8-bit).  In the case where the
source image has a bit depth &lt; 8 the transformation preserves
all the information; where the source image has bit depth
&gt; 8, then rescaling to 8-bit values loses precision.  No
dithering is performed.  Like <a class="reference internal" href="#libs.flowlib.png.Reader.asRGB" title="libs.flowlib.png.Reader.asRGB"><code class="xref py py-meth docutils literal notranslate"><span class="pre">asRGB()</span></code></a>, an alpha channel
in the source image will raise an exception.</p>
<p>This function returns a 4-tuple:
(<em>width</em>, <em>height</em>, <em>pixels</em>, <em>metadata</em>).
<em>width</em>, <em>height</em>, <em>metadata</em> are as per the
<a class="reference internal" href="#libs.flowlib.png.Reader.read" title="libs.flowlib.png.Reader.read"><code class="xref py py-meth docutils literal notranslate"><span class="pre">read()</span></code></a> method.</p>
<p><em>pixels</em> is the pixel data in boxed row flat pixel format.</p>
</dd></dl>

<dl class="py method">
<dt id="libs.flowlib.png.Reader.asRGBA">
<code class="sig-name descname"><span class="pre">asRGBA</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/libs/flowlib/png.html#Reader.asRGBA"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#libs.flowlib.png.Reader.asRGBA" title="Permalink to this definition">¶</a></dt>
<dd><p>Return image as RGBA pixels.  Greyscales are expanded into
RGB triplets; an alpha channel is synthesized if necessary.
The return values are as for the <a class="reference internal" href="#libs.flowlib.png.Reader.read" title="libs.flowlib.png.Reader.read"><code class="xref py py-meth docutils literal notranslate"><span class="pre">read()</span></code></a> method
except that the <em>metadata</em> reflect the returned pixels, not the
source image.  In particular, for this method
<code class="docutils literal notranslate"><span class="pre">metadata['greyscale']</span></code> will be <code class="docutils literal notranslate"><span class="pre">False</span></code>, and
<code class="docutils literal notranslate"><span class="pre">metadata['alpha']</span></code> will be <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt id="libs.flowlib.png.Reader.asRGBA8">
<code class="sig-name descname"><span class="pre">asRGBA8</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/libs/flowlib/png.html#Reader.asRGBA8"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#libs.flowlib.png.Reader.asRGBA8" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the image data as RGBA pixels with 8-bits per
sample.  This method is similar to <a class="reference internal" href="#libs.flowlib.png.Reader.asRGB8" title="libs.flowlib.png.Reader.asRGB8"><code class="xref py py-meth docutils literal notranslate"><span class="pre">asRGB8()</span></code></a> and
<a class="reference internal" href="#libs.flowlib.png.Reader.asRGBA" title="libs.flowlib.png.Reader.asRGBA"><code class="xref py py-meth docutils literal notranslate"><span class="pre">asRGBA()</span></code></a>:  The result pixels have an alpha channel, <em>and</em>
values are rescaled to the range 0 to 255.  The alpha channel is
synthesized if necessary (with a small speed penalty).</p>
</dd></dl>

<dl class="py method">
<dt id="libs.flowlib.png.Reader.chunk">
<code class="sig-name descname"><span class="pre">chunk</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seek</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lenient</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/libs/flowlib/png.html#Reader.chunk"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#libs.flowlib.png.Reader.chunk" title="Permalink to this definition">¶</a></dt>
<dd><p>Read the next PNG chunk from the input file; returns a
(<em>type</em>, <em>data</em>) tuple.  <em>type</em> is the chunk’s type as a
byte string (all PNG chunk types are 4 bytes long).
<em>data</em> is the chunk’s data content, as a byte string.</p>
<p>If the optional <cite>seek</cite> argument is
specified then it will keep reading chunks until it either runs
out of file or finds the type specified by the argument.  Note
that in general the order of chunks in PNGs is unspecified, so
using <cite>seek</cite> can cause you to miss chunks.</p>
<p>If the optional <cite>lenient</cite> argument evaluates to <cite>True</cite>,
checksum failures will raise warnings rather than exceptions.</p>
</dd></dl>

<dl class="py method">
<dt id="libs.flowlib.png.Reader.chunklentype">
<code class="sig-name descname"><span class="pre">chunklentype</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/libs/flowlib/png.html#Reader.chunklentype"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#libs.flowlib.png.Reader.chunklentype" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads just enough of the input to determine the next
chunk’s length and type, returned as a (<em>length</em>, <em>type</em>) pair
where <em>type</em> is a string.  If there are no more chunks, <code class="docutils literal notranslate"><span class="pre">None</span></code>
is returned.</p>
</dd></dl>

<dl class="py method">
<dt id="libs.flowlib.png.Reader.chunks">
<code class="sig-name descname"><span class="pre">chunks</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/libs/flowlib/png.html#Reader.chunks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#libs.flowlib.png.Reader.chunks" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an iterator that will yield each chunk as a
(<em>chunktype</em>, <em>content</em>) pair.</p>
</dd></dl>

<dl class="py method">
<dt id="libs.flowlib.png.Reader.deinterlace">
<code class="sig-name descname"><span class="pre">deinterlace</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raw</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/libs/flowlib/png.html#Reader.deinterlace"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#libs.flowlib.png.Reader.deinterlace" title="Permalink to this definition">¶</a></dt>
<dd><p>Read raw pixel data, undo filters, deinterlace, and flatten.
Return in flat row flat pixel format.</p>
</dd></dl>

<dl class="py method">
<dt id="libs.flowlib.png.Reader.iterboxed">
<code class="sig-name descname"><span class="pre">iterboxed</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rows</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/libs/flowlib/png.html#Reader.iterboxed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#libs.flowlib.png.Reader.iterboxed" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterator that yields each scanline in boxed row flat pixel
format.  <cite>rows</cite> should be an iterator that yields the bytes of
each row in turn.</p>
</dd></dl>

<dl class="py method">
<dt id="libs.flowlib.png.Reader.iterstraight">
<code class="sig-name descname"><span class="pre">iterstraight</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raw</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/libs/flowlib/png.html#Reader.iterstraight"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#libs.flowlib.png.Reader.iterstraight" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterator that undoes the effect of filtering, and yields
each row in serialised format (as a sequence of bytes).
Assumes input is straightlaced.  <cite>raw</cite> should be an iterable
that yields the raw bytes in chunks of arbitrary size.</p>
</dd></dl>

<dl class="py method">
<dt id="libs.flowlib.png.Reader.palette">
<code class="sig-name descname"><span class="pre">palette</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'natural'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/libs/flowlib/png.html#Reader.palette"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#libs.flowlib.png.Reader.palette" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a palette that is a sequence of 3-tuples or 4-tuples,
synthesizing it from the <code class="docutils literal notranslate"><span class="pre">PLTE</span></code> and <code class="docutils literal notranslate"><span class="pre">tRNS</span></code> chunks.  These
chunks should have already been processed (for example, by
calling the <a class="reference internal" href="#libs.flowlib.png.Reader.preamble" title="libs.flowlib.png.Reader.preamble"><code class="xref py py-meth docutils literal notranslate"><span class="pre">preamble()</span></code></a> method).  All the tuples are the
same size: 3-tuples if there is no <code class="docutils literal notranslate"><span class="pre">tRNS</span></code> chunk, 4-tuples when
there is a <code class="docutils literal notranslate"><span class="pre">tRNS</span></code> chunk.  Assumes that the image is colour type
3 and therefore a <code class="docutils literal notranslate"><span class="pre">PLTE</span></code> chunk is required.</p>
<p>If the <cite>alpha</cite> argument is <code class="docutils literal notranslate"><span class="pre">'force'</span></code> then an alpha channel is
always added, forcing the result to be a sequence of 4-tuples.</p>
</dd></dl>

<dl class="py method">
<dt id="libs.flowlib.png.Reader.preamble">
<code class="sig-name descname"><span class="pre">preamble</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lenient</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/libs/flowlib/png.html#Reader.preamble"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#libs.flowlib.png.Reader.preamble" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract the image metadata by reading the initial part of
the PNG file up to the start of the <code class="docutils literal notranslate"><span class="pre">IDAT</span></code> chunk.  All the
chunks that precede the <code class="docutils literal notranslate"><span class="pre">IDAT</span></code> chunk are read and either
processed for metadata or discarded.</p>
<p>If the optional <cite>lenient</cite> argument evaluates to <cite>True</cite>, checksum
failures will raise warnings rather than exceptions.</p>
</dd></dl>

<dl class="py method">
<dt id="libs.flowlib.png.Reader.process_chunk">
<code class="sig-name descname"><span class="pre">process_chunk</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lenient</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/libs/flowlib/png.html#Reader.process_chunk"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#libs.flowlib.png.Reader.process_chunk" title="Permalink to this definition">¶</a></dt>
<dd><p>Process the next chunk and its data.  This only processes the
following chunk types, all others are ignored: <code class="docutils literal notranslate"><span class="pre">IHDR</span></code>,
<code class="docutils literal notranslate"><span class="pre">PLTE</span></code>, <code class="docutils literal notranslate"><span class="pre">bKGD</span></code>, <code class="docutils literal notranslate"><span class="pre">tRNS</span></code>, <code class="docutils literal notranslate"><span class="pre">gAMA</span></code>, <code class="docutils literal notranslate"><span class="pre">sBIT</span></code>, <code class="docutils literal notranslate"><span class="pre">pHYs</span></code>.</p>
<p>If the optional <cite>lenient</cite> argument evaluates to <cite>True</cite>,
checksum failures will raise warnings rather than exceptions.</p>
</dd></dl>

<dl class="py method">
<dt id="libs.flowlib.png.Reader.read">
<code class="sig-name descname"><span class="pre">read</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lenient</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/libs/flowlib/png.html#Reader.read"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#libs.flowlib.png.Reader.read" title="Permalink to this definition">¶</a></dt>
<dd><p>Read the PNG file and decode it.  Returns (<cite>width</cite>, <cite>height</cite>,
<cite>pixels</cite>, <cite>metadata</cite>).</p>
<p>May use excessive memory.</p>
<p><cite>pixels</cite> are returned in boxed row flat pixel format.</p>
<p>If the optional <cite>lenient</cite> argument evaluates to True,
checksum failures will raise warnings rather than exceptions.</p>
</dd></dl>

<dl class="py method">
<dt id="libs.flowlib.png.Reader.read_flat">
<code class="sig-name descname"><span class="pre">read_flat</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/libs/flowlib/png.html#Reader.read_flat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#libs.flowlib.png.Reader.read_flat" title="Permalink to this definition">¶</a></dt>
<dd><p>Read a PNG file and decode it into flat row flat pixel format.
Returns (<em>width</em>, <em>height</em>, <em>pixels</em>, <em>metadata</em>).</p>
<p>May use excessive memory.</p>
<p><cite>pixels</cite> are returned in flat row flat pixel format.</p>
<p>See also the <a class="reference internal" href="#libs.flowlib.png.Reader.read" title="libs.flowlib.png.Reader.read"><code class="xref py py-meth docutils literal notranslate"><span class="pre">read()</span></code></a> method which returns pixels in the
more stream-friendly boxed row flat pixel format.</p>
</dd></dl>

<dl class="py method">
<dt id="libs.flowlib.png.Reader.serialtoflat">
<code class="sig-name descname"><span class="pre">serialtoflat</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bytes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/libs/flowlib/png.html#Reader.serialtoflat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#libs.flowlib.png.Reader.serialtoflat" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert serial format (byte stream) pixel data to flat row
flat pixel.</p>
</dd></dl>

<dl class="py method">
<dt id="libs.flowlib.png.Reader.undo_filter">
<code class="sig-name descname"><span class="pre">undo_filter</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filter_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scanline</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">previous</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/libs/flowlib/png.html#Reader.undo_filter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#libs.flowlib.png.Reader.undo_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Undo the filter for a scanline.  <cite>scanline</cite> is a sequence of
bytes that does not include the initial filter type byte.
<cite>previous</cite> is decoded previous scanline (for straightlaced
images this is the previous pixel row, but for interlaced
images, it is the previous scanline in the reduced image, which
in general is not the previous pixel row in the final image).
When there is no previous scanline (the first row of a
straightlaced image, or the first row in one of the passes in an
interlaced image), then this argument should be <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
<p>The scanline will have the effects of filtering removed, and the
result will be returned as a fresh sequence of bytes.</p>
</dd></dl>

<dl class="py method">
<dt id="libs.flowlib.png.Reader.validate_signature">
<code class="sig-name descname"><span class="pre">validate_signature</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/libs/flowlib/png.html#Reader.validate_signature"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#libs.flowlib.png.Reader.validate_signature" title="Permalink to this definition">¶</a></dt>
<dd><p>If signature (header) has not been read then read and
validate it; otherwise do nothing.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="libs.flowlib.png.Writer">
<em class="property"><span class="pre">class</span> </em><code class="sig-name descname"><span class="pre">Writer</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">height</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">greyscale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bitdepth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">palette</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transparent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">background</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compression</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interlace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bytes_per_sample</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">planes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colormap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chunk_limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1048576</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_pixels_per_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_pixels_per_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unit_is_meter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/libs/flowlib/png.html#Writer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#libs.flowlib.png.Writer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>PNG encoder in pure Python.</p>
<dl class="py method">
<dt id="libs.flowlib.png.Writer.__init__">
<code class="sig-name descname"><span class="pre">__init__</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">height</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">greyscale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bitdepth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">palette</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transparent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">background</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compression</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interlace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bytes_per_sample</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">planes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colormap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chunk_limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1048576</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_pixels_per_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_pixels_per_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unit_is_meter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/libs/flowlib/png.html#Writer.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#libs.flowlib.png.Writer.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a PNG encoder object.</p>
<p>Arguments:</p>
<dl class="simple">
<dt>width, height</dt><dd><p>Image size in pixels, as two separate arguments.</p>
</dd>
<dt>size</dt><dd><p>Image size (w,h) in pixels, as single argument.</p>
</dd>
<dt>greyscale</dt><dd><p>Input data is greyscale, not RGB.</p>
</dd>
<dt>alpha</dt><dd><p>Input data has alpha channel (RGBA or LA).</p>
</dd>
<dt>bitdepth</dt><dd><p>Bit depth: from 1 to 16.</p>
</dd>
<dt>palette</dt><dd><p>Create a palette for a colour mapped image (colour type 3).</p>
</dd>
<dt>transparent</dt><dd><p>Specify a transparent colour (create a <code class="docutils literal notranslate"><span class="pre">tRNS</span></code> chunk).</p>
</dd>
<dt>background</dt><dd><p>Specify a default background colour (create a <code class="docutils literal notranslate"><span class="pre">bKGD</span></code> chunk).</p>
</dd>
<dt>gamma</dt><dd><p>Specify a gamma value (create a <code class="docutils literal notranslate"><span class="pre">gAMA</span></code> chunk).</p>
</dd>
<dt>compression</dt><dd><p>zlib compression level: 0 (none) to 9 (more compressed);
default: -1 or None.</p>
</dd>
<dt>interlace</dt><dd><p>Create an interlaced image.</p>
</dd>
<dt>chunk_limit</dt><dd><p>Write multiple <code class="docutils literal notranslate"><span class="pre">IDAT</span></code> chunks to save memory.</p>
</dd>
<dt>x_pixels_per_unit</dt><dd><p>Number of pixels a unit along the x axis (write a
<cite>pHYs</cite> chunk).</p>
</dd>
<dt>y_pixels_per_unit</dt><dd><p>Number of pixels a unit along the y axis (write a
<cite>pHYs</cite> chunk). Along with <cite>x_pixel_unit</cite>, this gives
the pixel size ratio.</p>
</dd>
<dt>unit_is_meter</dt><dd><p><cite>True</cite> to indicate that the unit (for the <cite>pHYs</cite>
chunk) is metre.</p>
</dd>
</dl>
<p>The image size (in pixels) can be specified either by using the
<cite>width</cite> and <cite>height</cite> arguments, or with the single <cite>size</cite>
argument.  If <cite>size</cite> is used it should be a pair (<em>width</em>,
<em>height</em>).</p>
<p><cite>greyscale</cite> and <cite>alpha</cite> are booleans that specify whether
an image is greyscale (or colour), and whether it has an
alpha channel (or not).</p>
<p><cite>bitdepth</cite> specifies the bit depth of the source pixel values.
Each source pixel value must be an integer between 0 and
<code class="docutils literal notranslate"><span class="pre">2**bitdepth-1</span></code>.  For example, 8-bit images have values
between 0 and 255.  PNG only stores images with bit depths of
1,2,4,8, or 16.  When <cite>bitdepth</cite> is not one of these values,
the next highest valid bit depth is selected, and an <code class="docutils literal notranslate"><span class="pre">sBIT</span></code>
(significant bits) chunk is generated that specifies the
original precision of the source image.  In this case the
supplied pixel values will be rescaled to fit the range of
the selected bit depth.</p>
<p>The details of which bit depth / colour model combinations the
PNG file format supports directly, are somewhat arcane
(refer to the PNG specification for full details).  Briefly:
“small” bit depths (1,2,4) are only allowed with greyscale and
colour mapped images; colour mapped images cannot have bit depth
16.</p>
<p>For colour mapped images (in other words, when the <cite>palette</cite>
argument is specified) the <cite>bitdepth</cite> argument must match one of
the valid PNG bit depths: 1, 2, 4, or 8.  (It is valid to have a
PNG image with a palette and an <code class="docutils literal notranslate"><span class="pre">sBIT</span></code> chunk, but the meaning
is slightly different; it would be awkward to press the
<cite>bitdepth</cite> argument into service for this.)</p>
<p>The <cite>palette</cite> option, when specified, causes a colour
mapped image to be created: the PNG colour type is set to 3;
<cite>greyscale</cite> must not be set; <cite>alpha</cite> must not be set;
<cite>transparent</cite> must not be set; the bit depth must be 1,2,4,
or 8.  When a colour mapped image is created, the pixel values
are palette indexes and the <cite>bitdepth</cite> argument specifies the
size of these indexes (not the size of the colour values in
the palette).</p>
<p>The palette argument value should be a sequence of 3- or
4-tuples.  3-tuples specify RGB palette entries; 4-tuples
specify RGBA palette entries.  If both 4-tuples and 3-tuples
appear in the sequence then all the 4-tuples must come
before all the 3-tuples.  A <code class="docutils literal notranslate"><span class="pre">PLTE</span></code> chunk is created; if there
are 4-tuples then a <code class="docutils literal notranslate"><span class="pre">tRNS</span></code> chunk is created as well.  The
<code class="docutils literal notranslate"><span class="pre">PLTE</span></code> chunk will contain all the RGB triples in the same
sequence; the <code class="docutils literal notranslate"><span class="pre">tRNS</span></code> chunk will contain the alpha channel for
all the 4-tuples, in the same sequence.  Palette entries
are always 8-bit.</p>
<p>If specified, the <cite>transparent</cite> and <cite>background</cite> parameters must
be a tuple with three integer values for red, green, blue, or
a simple integer (or singleton tuple) for a greyscale image.</p>
<p>If specified, the <cite>gamma</cite> parameter must be a positive number
(generally, a <cite>float</cite>).  A <code class="docutils literal notranslate"><span class="pre">gAMA</span></code> chunk will be created.
Note that this will not change the values of the pixels as
they appear in the PNG file, they are assumed to have already
been converted appropriately for the gamma specified.</p>
<p>The <cite>compression</cite> argument specifies the compression level to
be used by the <code class="docutils literal notranslate"><span class="pre">zlib</span></code> module.  Values from 1 to 9 specify
compression, with 9 being “more compressed” (usually smaller
and slower, but it doesn’t always work out that way).  0 means
no compression.  -1 and <code class="docutils literal notranslate"><span class="pre">None</span></code> both mean that the default
level of compession will be picked by the <code class="docutils literal notranslate"><span class="pre">zlib</span></code> module
(which is generally acceptable).</p>
<p>If <cite>interlace</cite> is true then an interlaced image is created
(using PNG’s so far only interace method, <em>Adam7</em>).  This does
not affect how the pixels should be presented to the encoder,
rather it changes how they are arranged into the PNG file.
On slow connexions interlaced images can be partially decoded
by the browser to give a rough view of the image that is
successively refined as more image data appears.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Enabling the <cite>interlace</cite> option requires the entire image
to be processed in working memory.</p>
</div>
<p><cite>chunk_limit</cite> is used to limit the amount of memory used whilst
compressing the image.  In order to avoid using large amounts of
memory, multiple <code class="docutils literal notranslate"><span class="pre">IDAT</span></code> chunks may be created.</p>
</dd></dl>

<dl class="py method">
<dt id="libs.flowlib.png.Writer.array_scanlines">
<code class="sig-name descname"><span class="pre">array_scanlines</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pixels</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/libs/flowlib/png.html#Writer.array_scanlines"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#libs.flowlib.png.Writer.array_scanlines" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates boxed rows (flat pixels) from flat rows (flat pixels)
in an array.</p>
</dd></dl>

<dl class="py method">
<dt id="libs.flowlib.png.Writer.array_scanlines_interlace">
<code class="sig-name descname"><span class="pre">array_scanlines_interlace</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pixels</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/libs/flowlib/png.html#Writer.array_scanlines_interlace"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#libs.flowlib.png.Writer.array_scanlines_interlace" title="Permalink to this definition">¶</a></dt>
<dd><p>Generator for interlaced scanlines from an array.  <cite>pixels</cite> is
the full source image in flat row flat pixel format.  The
generator yields each scanline of the reduced passes in turn, in
boxed row flat pixel format.</p>
</dd></dl>

<dl class="py method">
<dt id="libs.flowlib.png.Writer.convert_pnm">
<code class="sig-name descname"><span class="pre">convert_pnm</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">infile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outfile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/libs/flowlib/png.html#Writer.convert_pnm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#libs.flowlib.png.Writer.convert_pnm" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a PNM file containing raw pixel data into a PNG file
with the parameters set in the writer object.  Works for
(binary) PGM, PPM, and PAM formats.</p>
</dd></dl>

<dl class="py method">
<dt id="libs.flowlib.png.Writer.convert_ppm_and_pgm">
<code class="sig-name descname"><span class="pre">convert_ppm_and_pgm</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ppmfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pgmfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outfile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/libs/flowlib/png.html#Writer.convert_ppm_and_pgm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#libs.flowlib.png.Writer.convert_ppm_and_pgm" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a PPM and PGM file containing raw pixel data into a
PNG outfile with the parameters set in the writer object.</p>
</dd></dl>

<dl class="py method">
<dt id="libs.flowlib.png.Writer.file_scanlines">
<code class="sig-name descname"><span class="pre">file_scanlines</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">infile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/libs/flowlib/png.html#Writer.file_scanlines"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#libs.flowlib.png.Writer.file_scanlines" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates boxed rows in flat pixel format, from the input file
<cite>infile</cite>.  It assumes that the input file is in a “Netpbm-like”
binary format, and is positioned at the beginning of the first
pixel.  The number of pixels to read is taken from the image
dimensions (<cite>width</cite>, <cite>height</cite>, <cite>planes</cite>) and the number of bytes
per value is implied by the image <cite>bitdepth</cite>.</p>
</dd></dl>

<dl class="py method">
<dt id="libs.flowlib.png.Writer.make_palette">
<code class="sig-name descname"><span class="pre">make_palette</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/libs/flowlib/png.html#Writer.make_palette"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#libs.flowlib.png.Writer.make_palette" title="Permalink to this definition">¶</a></dt>
<dd><p>Create the byte sequences for a <code class="docutils literal notranslate"><span class="pre">PLTE</span></code> and if necessary a
<code class="docutils literal notranslate"><span class="pre">tRNS</span></code> chunk.  Returned as a pair (<em>p</em>, <em>t</em>).  <em>t</em> will be
<code class="docutils literal notranslate"><span class="pre">None</span></code> if no <code class="docutils literal notranslate"><span class="pre">tRNS</span></code> chunk is necessary.</p>
</dd></dl>

<dl class="py method">
<dt id="libs.flowlib.png.Writer.write">
<code class="sig-name descname"><span class="pre">write</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">outfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rows</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/libs/flowlib/png.html#Writer.write"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#libs.flowlib.png.Writer.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a PNG image to the output file.  <cite>rows</cite> should be
an iterable that yields each row in boxed row flat pixel
format.  The rows should be the rows of the original image,
so there should be <code class="docutils literal notranslate"><span class="pre">self.height</span></code> rows of <code class="docutils literal notranslate"><span class="pre">self.width</span> <span class="pre">*</span>
<span class="pre">self.planes</span></code> values.  If <cite>interlace</cite> is specified (when
creating the instance), then an interlaced PNG file will
be written.  Supply the rows in the normal image order;
the interlacing is carried out internally.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Interlacing will require the entire image to be in working
memory.</p>
</div>
</dd></dl>

<dl class="py method">
<dt id="libs.flowlib.png.Writer.write_array">
<code class="sig-name descname"><span class="pre">write_array</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">outfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixels</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/libs/flowlib/png.html#Writer.write_array"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#libs.flowlib.png.Writer.write_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Write an array in flat row flat pixel format as a PNG file on
the output file.  See also <a class="reference internal" href="#libs.flowlib.png.Writer.write" title="libs.flowlib.png.Writer.write"><code class="xref py py-meth docutils literal notranslate"><span class="pre">write()</span></code></a> method.</p>
</dd></dl>

<dl class="py method">
<dt id="libs.flowlib.png.Writer.write_packed">
<code class="sig-name descname"><span class="pre">write_packed</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">outfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rows</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/libs/flowlib/png.html#Writer.write_packed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#libs.flowlib.png.Writer.write_packed" title="Permalink to this definition">¶</a></dt>
<dd><p>Write PNG file to <cite>outfile</cite>.  The pixel data comes from <cite>rows</cite>
which should be in boxed row packed format.  Each row should be
a sequence of packed bytes.</p>
<p>Technically, this method does work for interlaced images but it
is best avoided.  For interlaced images, the rows should be
presented in the order that they appear in the file.</p>
<p>This method should not be used when the source image bit depth
is not one naturally supported by PNG; the bit depth should be
1, 2, 4, 8, or 16.</p>
</dd></dl>

<dl class="py method">
<dt id="libs.flowlib.png.Writer.write_passes">
<code class="sig-name descname"><span class="pre">write_passes</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">outfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rows</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">packed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/libs/flowlib/png.html#Writer.write_passes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#libs.flowlib.png.Writer.write_passes" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a PNG image to the output file.</p>
<p>Most users are expected to find the <a class="reference internal" href="#libs.flowlib.png.Writer.write" title="libs.flowlib.png.Writer.write"><code class="xref py py-meth docutils literal notranslate"><span class="pre">write()</span></code></a> or
<a class="reference internal" href="#libs.flowlib.png.Writer.write_array" title="libs.flowlib.png.Writer.write_array"><code class="xref py py-meth docutils literal notranslate"><span class="pre">write_array()</span></code></a> method more convenient.</p>
<p>The rows should be given to this method in the order that
they appear in the output file.  For straightlaced images,
this is the usual top to bottom ordering, but for interlaced
images the rows should have already been interlaced before
passing them to this function.</p>
<p><cite>rows</cite> should be an iterable that yields each row.  When
<cite>packed</cite> is <code class="docutils literal notranslate"><span class="pre">False</span></code> the rows should be in boxed row flat pixel
format; when <cite>packed</cite> is <code class="docutils literal notranslate"><span class="pre">True</span></code> each row should be a packed
sequence of bytes.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="libs.flowlib.png.from_array">
<code class="sig-name descname"><span class="pre">from_array</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">info</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/libs/flowlib/png.html#from_array"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#libs.flowlib.png.from_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a PNG <a class="reference internal" href="#libs.flowlib.png.Image" title="libs.flowlib.png.Image"><code class="xref py py-class docutils literal notranslate"><span class="pre">Image</span></code></a> object from a 2- or 3-dimensional
array.  One application of this function is easy PIL-style saving:
<code class="docutils literal notranslate"><span class="pre">png.from_array(pixels,</span> <span class="pre">'L').save('foo.png')</span></code>.</p>
<p>Unless they are specified using the <em>info</em> parameter, the PNG’s
height and width are taken from the array size.  For a 3 dimensional
array the first axis is the height; the second axis is the width;
and the third axis is the channel number.  Thus an RGB image that is
16 pixels high and 8 wide will use an array that is 16x8x3.  For 2
dimensional arrays the first axis is the height, but the second axis
is <code class="docutils literal notranslate"><span class="pre">width*channels</span></code>, so an RGB image that is 16 pixels high and 8
wide will use a 2-dimensional array that is 16x24 (each row will be
8*3 = 24 sample values).</p>
<p><em>mode</em> is a string that specifies the image colour format in a
PIL-style mode.  It can be:</p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">'L'</span></code></dt><dd><p>greyscale (1 channel)</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">'LA'</span></code></dt><dd><p>greyscale with alpha (2 channel)</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">'RGB'</span></code></dt><dd><p>colour image (3 channel)</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">'RGBA'</span></code></dt><dd><p>colour image with alpha (4 channel)</p>
</dd>
</dl>
<p>The mode string can also specify the bit depth (overriding how this
function normally derives the bit depth, see below).  Appending
<code class="docutils literal notranslate"><span class="pre">';16'</span></code> to the mode will cause the PNG to be 16 bits per channel;
any decimal from 1 to 16 can be used to specify the bit depth.</p>
<p>When a 2-dimensional array is used <em>mode</em> determines how many
channels the image has, and so allows the width to be derived from
the second array dimension.</p>
<p>The array is expected to be a <code class="docutils literal notranslate"><span class="pre">numpy</span></code> array, but it can be any
suitable Python sequence.  For example, a list of lists can be used:
<code class="docutils literal notranslate"><span class="pre">png.from_array([[0,</span> <span class="pre">255,</span> <span class="pre">0],</span> <span class="pre">[255,</span> <span class="pre">0,</span> <span class="pre">255]],</span> <span class="pre">'L')</span></code>.  The exact
rules are: <code class="docutils literal notranslate"><span class="pre">len(a)</span></code> gives the first dimension, height;
<code class="docutils literal notranslate"><span class="pre">len(a[0])</span></code> gives the second dimension; <code class="docutils literal notranslate"><span class="pre">len(a[0][0])</span></code> gives the
third dimension, unless an exception is raised in which case a
2-dimensional array is assumed.  It’s slightly more complicated than
that because an iterator of rows can be used, and it all still
works.  Using an iterator allows data to be streamed efficiently.</p>
<p>The bit depth of the PNG is normally taken from the array element’s
datatype (but if <em>mode</em> specifies a bitdepth then that is used
instead).  The array element’s datatype is determined in a way which
is supposed to work both for <code class="docutils literal notranslate"><span class="pre">numpy</span></code> arrays and for Python
<code class="docutils literal notranslate"><span class="pre">array.array</span></code> objects.  A 1 byte datatype will give a bit depth of
8, a 2 byte datatype will give a bit depth of 16.  If the datatype
does not have an implicit size, for example it is a plain Python
list of lists, as above, then a default of 8 is used.</p>
<p>The <em>info</em> parameter is a dictionary that can be used to specify
metadata (in the same style as the arguments to the
<code class="xref py py-class docutils literal notranslate"><span class="pre">png.Writer</span></code> class).  For this function the keys that are
useful are:</p>
<dl class="simple">
<dt>height</dt><dd><p>overrides the height derived from the array dimensions and allows
<em>a</em> to be an iterable.</p>
</dd>
<dt>width</dt><dd><p>overrides the width derived from the array dimensions.</p>
</dd>
<dt>bitdepth</dt><dd><p>overrides the bit depth derived from the element datatype (but
must match <em>mode</em> if that also specifies a bit depth).</p>
</dd>
</dl>
<p>Generally anything specified in the
<em>info</em> dictionary will override any implicit choices that this
function would otherwise make, but must match any explicit ones.
For example, if the <em>info</em> dictionary has a <code class="docutils literal notranslate"><span class="pre">greyscale</span></code> key then
this must be true when mode is <code class="docutils literal notranslate"><span class="pre">'L'</span></code> or <code class="docutils literal notranslate"><span class="pre">'LA'</span></code> and false when
mode is <code class="docutils literal notranslate"><span class="pre">'RGB'</span></code> or <code class="docutils literal notranslate"><span class="pre">'RGBA'</span></code>.</p>
</dd></dl>

<dl class="py function">
<dt id="libs.flowlib.png.write_chunks">
<code class="sig-name descname"><span class="pre">write_chunks</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">out</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chunks</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/libs/flowlib/png.html#write_chunks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#libs.flowlib.png.write_chunks" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a PNG file by writing out the chunks.</p>
</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="libs.general.html" class="btn btn-neutral float-right" title="libs.general" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="libs.flowlib.flowlib.html" class="btn btn-neutral float-left" title="libs.flowlib.flowlib" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Huangying Zhan

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>